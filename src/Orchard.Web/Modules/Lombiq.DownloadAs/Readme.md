# Download as... Orchard module Readme



## Project Description

Orchard module for providing users the ability to download content items as a variety of files.


## Features

- Generates downloadable files out of content items
- HTML, PDF and Markdown types supported but the module is extensible
- Container items are flattened: their contained items are added to the output (if the contained items are linked from the container's html they will keep the linking order)
- Links pointing to other items that are also part of the output file are converted to in-page links
- File downloads honour content item permissions
- Content part for automatically displaying download links


## Documentation

**This module depends on [Helpful Libraries](https://github.com/Lombiq/Helpful-Libraries). Please install it first!**

You can see a demo of the module on the [Orchard Community meeting podcast](http://youtu.be/7cFFTc866wA?t=48m4s).

### Usage

**Notice:** due to an [Orchard.OutputCache](https://orchard.codeplex.com/workitem/20085) bug when output caching is enabled the files retuned will be blank. To circumvent this set up OutputCache to ignore file download URLs.

Keep in mind that different output types (e.g. HTML or PDF) are in separate features.

After installation you'll get a new content part, DownloadLinkPart. You can attach this to content types where you want to display an automatic list of download links at the items. Items can be downloaded directly by opening the download URL with the following pattern: `/Lombiq.DownloadAs/Download/DownloadAs/<item ID>?Extension=<file extension, e.g. html>`.

The module adds some configuration options to General settings.

Containers are flattened in the following way:

- If an item contains other items, those other items will be added to the file output too. This happens recursively, i.e. items contained by contained items are also fetched.
- By default all contained items are taken into account and their order is their creation order.
- If contained items are linked from the container's HTML output then these links will take precedence in two ways: their order will determine the items' order and if an item is not linked it will be not included in the output despite being contained.

Files are generated by first creating the HTML output of content items. You can customize this HTML output, and through it the file outputs in the following ways:

- The display type used when building the output of content items is `"File-<extension"`, e.g. `"File-html"`.
- The display type used when building the output of an item to see whether its contained items are linked is `"File-ContainerFlattening"`.
- The document shape around the list of items is called `"File.ContentsWrapper"` and it has the following alternates: `"FileContentsWrapper<extension>"` (e.g. File.ContentsWrapper-html), `"FileContentsWrapper<extension><content item ID>"` (e.g. File.ContentsWrapper-html-32) and `"FileContentsWrapper_<content item ID>"` (e.g. File.ContentsWrapper-32).

### Adding new file types

The module is extensible so you can add services for supporting other file types too. For this you have to write an IFileBuildWorker implementation. Take a look at the existing implementations in the module for examples.

The module's source is available in two public source repositories, automatically mirrored in both directions with [Git-hg Mirror](https://githgmirror.com):

- [https://bitbucket.org/Lombiq/orchard-download-as](https://bitbucket.org/Lombiq/orchard-download-as) (Mercurial repository)
- [https://github.com/Lombiq/Orchard-Download-As](https://github.com/Lombiq/Orchard-Download-As) (Git repository)

Bug reports, feature requests and comments are warmly welcome, **please do so via GitHub**.
Feel free to send pull requests too, no matter which source repository you choose for this purpose.

This project is developed by [Lombiq Technologies Ltd](http://lombiq.com/). Commercial-grade support is available through Lombiq.